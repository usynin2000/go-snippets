// –í—Å–µ —Ç—Ä–∏ –≤–æ—Ä–∫–µ—Ä–∞ —Ä–∞–±–æ—Ç–∞—é—Ç –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ (–∏–ª–∏ –ø—Å–µ–≤–¥–æ–ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ, –µ—Å–ª–∏ —É —Ç–µ–±—è –æ–¥–Ω–æ —è–¥—Ä–æ).
// –ü–æ—Ä—è–¥–æ–∫ –≤—ã–≤–æ–¥–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å —Ä–∞–∑–Ω—ã–º –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—É—Å–∫–µ.

package main

import (
	"fmt"
	"sync"
)

func worker(id int, wg *sync.WaitGroup) {
	defer wg.Done()
	fmt.Printf("Worker %d is working\n", id)
}

// id ‚Äî –Ω–æ–º–µ—Ä —Ä–∞–±–æ—á–µ–≥–æ (–ø—Ä–æ—Å—Ç–æ –¥–ª—è –ø—Ä–∏–º–µ—Ä–∞).

// wg ‚Äî —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ WaitGroup, –æ–±—â–∏–π –¥–ª—è –≤—Å–µ—Ö –≥–æ—Ä—É—Ç–∏–Ω.

// defer wg.Done() ‚Äî –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ –ø—Ä–∏ –≤—ã—Ö–æ–¥–µ –∏–∑ —Ñ—É–Ω–∫—Ü–∏–∏ –±—É–¥–µ—Ç –≤—ã–∑–≤–∞–Ω wg.Done(), —É–º–µ–Ω—å—à–∞—é—â–∏–π —Å—á—ë—Ç—á–∏–∫ –∞–∫—Ç–∏–≤–Ω—ã—Ö –∑–∞–¥–∞—á –Ω–∞ 1.

// fmt.Printf(...) ‚Äî –ø—Ä–æ—Å—Ç–æ –ø–µ—á–∞—Ç–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ.

func main() {
	var wg sync.WaitGroup // var wg sync.WaitGroup ‚Äî —Å–æ–∑–¥–∞—ë—Ç—Å—è –≥—Ä—É–ø–ø–∞ –æ–∂–∏–¥–∞–Ω–∏—è.
	for i := 1; i <= 3; i++ {
		wg.Add(1) // —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç —Å—á—ë—Ç—á–∏–∫ –∑–∞–¥–∞—á –Ω–∞ 1 (–≥–æ–≤–æ—Ä–∏–º: ¬´–±—É–¥–µ—Ç –µ—â—ë –æ–¥–Ω–∞ –≥–æ—Ä—É—Ç–∏–Ω–∞¬ª).
		go worker(i, &wg) // –∑–∞–ø—É—Å–∫–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏—é worker –∫–∞–∫ –≥–æ—Ä—É—Ç–∏–Ω–∏—é, —Ç–æ –µ—Å—Ç—å –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –ø–æ—Ç–æ–∫–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
	}
	
	wg.Wait()
	// –ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –≤—Å–µ—Ö –≥–æ—Ä—É—Ç–∏–Ω –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è wg.Wait() ‚Äî –±–ª–æ–∫–∏—Ä—É–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ main, –ø–æ–∫–∞ –≤—Å–µ –≥–æ—Ä—É—Ç–∏–Ω—ã –Ω–µ –≤—ã–∑–æ–≤—É—Ç wg.Done().

	fmt.Println("all workers are done\n")

	// –ö–æ–≥–¥–∞ —Å—á—ë—Ç—á–∏–∫ –¥–æ–π–¥—ë—Ç –¥–æ 0, –ø—Ä–æ–≥—Ä–∞–º–º–∞ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∏ –ø–µ—á–∞—Ç–∞–µ—Ç "all workers are done".
}

// –û–Ω–∞ –∑–∞–ø—É—Å–∫–∞–µ—Ç —Ç—Ä–∏ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –≥–æ—Ä—É—Ç–∏–Ω—ã
// –∏ –∑–∞—Ç–µ–º –∂–¥—ë—Ç, –ø–æ–∫–∞ –≤—Å–µ –æ–Ω–∏ –∑–∞–∫–æ–Ω—á–∞—Ç —Ä–∞–±–æ—Ç—É, –ø—Ä–µ–∂–¥–µ —á–µ–º –≤—ã–≤–µ—Å—Ç–∏
// all workers are done.


// –ì–æ—Ä—É—Ç–∏–Ω–∞ (goroutine) ‚Äî —ç—Ç–æ –ª—ë–≥–∫–∏–π –ø–æ—Ç–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è (lightweight thread), 
// –∫–æ—Ç–æ—Ä—ã–π —Å–æ–∑–¥–∞—ë—Ç—Å—è —Å –ø–æ–º–æ—â—å—é –∫–ª—é—á–µ–≤–æ–≥–æ —Å–ª–æ–≤–∞ go –≤ Go.

// üß© –ü—Ä–æ—â–µ –≥–æ–≤–æ—Ä—è:

// –ö–æ–≥–¥–∞ —Ç—ã –ø–∏—à–µ—à—å

// go someFunction()

// Go –Ω–µ –∂–¥—ë—Ç, –ø–æ–∫–∞ someFunction() –∑–∞–∫–æ–Ω—á–∏—Ç—Å—è ‚Äî
// –æ–Ω–∞ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –≤ —Ñ–æ–Ω–µ, –∞ –æ—Å–Ω–æ–≤–Ω–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –¥–∞–ª—å—à–µ.


// üí° –ì–ª–∞–≤–Ω–æ–µ –æ—Ç–ª–∏—á–∏–µ –æ—Ç –æ–±—ã—á–Ω—ã—Ö –ø–æ—Ç–æ–∫–æ–≤ (threads):

// - –ì–æ—Ä—É—Ç–∏–Ω—ã –æ—á–µ–Ω—å –ª—ë–≥–∫–∏–µ ‚Äî –º–æ–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å —Ç—ã—Å—è—á–∏ (–¥–∞–∂–µ –º–∏–ª–ª–∏–æ–Ω—ã) –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ.
// - –û–Ω–∏ —É–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–æ–º Go, –∞ –Ω–µ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º–æ–π.
// - –û–¥–∏–Ω –ø–æ—Ç–æ–∫ –û–° –º–æ–∂–µ—Ç –æ–±—Å–ª—É–∂–∏–≤–∞—Ç—å –º–Ω–æ–∂–µ—Å—Ç–≤–æ –≥–æ—Ä—É—Ç–∏–Ω, –ø–µ—Ä–µ–∫–ª—é—á–∞—è –∏—Ö –ø–æ –º–µ—Ä–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏.

// (Go –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç.–Ω. M:N scheduler, –≥–¥–µ M ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –ø–æ—Ç–æ–∫–æ–≤, –∞ N ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≥–æ—Ä—É—Ç–∏–Ω.)